{"version":3,"file":"octo-thorpe.js","sources":["../../src/lib/web-components/octo-thorpe/OctoThorpe.svelte"],"sourcesContent":["<svelte:options customElement=\"octo-thorpe\" />\n\n<script>\n  import { onMount } from 'svelte';\n  import { createOctoQuery } from '../shared/octo-store.js';\n  import { getTitle, getUrl, formatDate } from '../shared/display-helpers.js';\n  \n  // API Configuration\n  export let server = 'https://octothorp.es';\n  \n  // Query parameters - map directly to API\n  export let o = '';           // Objects (thorpe terms) - comma-separated\n  export let s = '';           // Subjects (domain filters) - comma-separated\n  export let noto = '';        // Exclude objects\n  export let nots = '';        // Exclude subjects\n  export let match = '';       // Match mode: exact, fuzzy, fuzzy-o, fuzzy-s, very-fuzzy\n  export let limit = '10';     // Result limit\n  export let offset = '0';     // Result offset\n  export let when = '';        // Date filter: recent, after-DATE, before-DATE, between-DATE-and-DATE\n  \n  // Behavior\n  export let autoload = false;  // Auto-load on mount\n  export let render = 'list';   // Render mode: list, cards, compact, count\n  \n  // Create the query store (always queries pages/thorped)\n  const query = createOctoQuery('pages', 'thorped');\n  \n  // Load function\n  async function load() {\n    await query.fetch({\n      server,\n      s,\n      o,\n      nots,\n      noto,\n      match,\n      limit,\n      offset,\n      when\n    });\n  }\n  \n  // Auto-load on mount if requested\n  onMount(() => {\n    if (autoload || autoload === '') {\n      load();\n    }\n  });\n  \n  // (Common display helpers imported from display-helpers.js)\n</script>\n\n{#if render === 'count'}\n  <!-- Just show the count -->\n  {#if $query.loading}\n    <span class=\"count-loading\">…</span>\n  {:else if $query.error}\n    <span class=\"count-error\">✗</span>\n  {:else}\n    <span class=\"count\">{$query.count}</span>\n  {/if}\n\n{:else}\n  <!-- Full component display -->\n  <div class=\"octo-thorpe\">\n    \n    {#if !$query.results.length && !$query.loading && !$query.error}\n      <button on:click={load} class=\"load-button\">\n        Load pages tagged \"{o || 'octothorpes'}\"\n      </button>\n    {/if}\n    \n    {#if $query.loading}\n      <div class=\"loading\">\n        <div class=\"spinner\"></div>\n        <p>Loading...</p>\n      </div>\n    {/if}\n    \n    {#if $query.error}\n      <div class=\"error\">\n        <p><strong>Error:</strong> {$query.error}</p>\n        <button on:click={load} class=\"retry-button\">Retry</button>\n      </div>\n    {/if}\n    \n    {#if $query.results.length > 0 && !$query.loading}\n      \n      {#if render === 'list'}\n        <ul class=\"list\">\n          {#each $query.results as item}\n            <li>\n              <a href={getUrl(item)} target=\"_blank\" rel=\"noopener noreferrer\">\n                {getTitle(item)}\n              </a>\n              {#if item.description}\n                <p class=\"description\">{item.description}</p>\n              {/if}\n              {#if item.date}\n                <time class=\"date\">{formatDate(item.date)}</time>\n              {/if}\n            </li>\n          {/each}\n        </ul>\n      \n      {:else if render === 'cards'}\n        <div class=\"cards\">\n          {#each $query.results as item}\n            <article class=\"card\">\n              {#if item.image}\n                <img src={item.image} alt={getTitle(item)} loading=\"lazy\" />\n              {/if}\n              <h3>\n                <a href={getUrl(item)} target=\"_blank\" rel=\"noopener noreferrer\">\n                  {getTitle(item)}\n                </a>\n              </h3>\n              {#if item.description}\n                <p class=\"description\">{item.description}</p>\n              {/if}\n              {#if item.date}\n                <time class=\"date\">{formatDate(item.date)}</time>\n              {/if}\n            </article>\n          {/each}\n        </div>\n      \n      {:else if render === 'compact'}\n        <div class=\"compact\">\n          {#each $query.results as item, i}\n            <a href={getUrl(item)} target=\"_blank\" rel=\"noopener noreferrer\">\n              {getTitle(item)}\n            </a>{#if i < $query.results.length - 1}, {/if}\n          {/each}\n        </div>\n      {/if}\n      \n      <div class=\"meta\">\n        <span class=\"result-count\">{$query.count} result{$query.count === 1 ? '' : 's'}</span>\n      </div>\n      \n    {/if}\n    \n  </div>\n{/if}\n\n<style>\n  /* CSS Custom Properties - all customizable */\n  :host {\n    --octo-font: system-ui, -apple-system, sans-serif;\n    --octo-primary: #3c7efb;\n    --octo-background: #ffffff;\n    --octo-text: #333333;\n    --octo-border: #e0e0e0;\n    --octo-error: #d32f2f;\n    --octo-spacing: 1rem;\n    --octo-radius: 4px;\n    \n    display: block;\n    font-family: var(--octo-font);\n    color: var(--octo-text);\n  }\n  \n  .octo-thorpe {\n    background: var(--octo-background);\n  }\n  \n  /* Count mode (inline) */\n  .count,\n  .count-loading,\n  .count-error {\n    font-weight: bold;\n  }\n  \n  .count-loading {\n    opacity: 0.5;\n  }\n  \n  .count-error {\n    color: var(--octo-error);\n  }\n  \n  /* Buttons */\n  .load-button,\n  .retry-button {\n    background: var(--octo-primary);\n    color: white;\n    border: none;\n    padding: 0.75rem 1.5rem;\n    font-size: 1rem;\n    font-family: var(--octo-font);\n    border-radius: var(--octo-radius);\n    cursor: pointer;\n    transition: opacity 0.2s;\n  }\n  \n  .load-button:hover,\n  .retry-button:hover {\n    opacity: 0.9;\n  }\n  \n  .retry-button {\n    background: var(--octo-error);\n  }\n  \n  /* Loading state */\n  .loading {\n    text-align: center;\n    padding: calc(var(--octo-spacing) * 2);\n  }\n  \n  .spinner {\n    width: 40px;\n    height: 40px;\n    margin: 0 auto var(--octo-spacing);\n    border: 4px solid var(--octo-border);\n    border-top-color: var(--octo-primary);\n    border-radius: 50%;\n    animation: spin 1s linear infinite;\n  }\n  \n  @keyframes spin {\n    to { transform: rotate(360deg); }\n  }\n  \n  .loading p {\n    margin: 0;\n    color: #666;\n  }\n  \n  /* Error state */\n  .error {\n    padding: var(--octo-spacing);\n    background: #ffebee;\n    border: 1px solid var(--octo-error);\n    border-radius: var(--octo-radius);\n    text-align: center;\n  }\n  \n  .error p {\n    color: var(--octo-error);\n    margin: 0 0 var(--octo-spacing) 0;\n  }\n  \n  /* List render mode */\n  .list {\n    list-style: none;\n    padding: 0;\n    margin: 0;\n  }\n  \n  .list li {\n    padding: var(--octo-spacing);\n    border-bottom: 1px solid var(--octo-border);\n  }\n  \n  .list li:last-child {\n    border-bottom: none;\n  }\n  \n  /* Cards render mode */\n  .cards {\n    display: grid;\n    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));\n    gap: var(--octo-spacing);\n  }\n  \n  .card {\n    padding: var(--octo-spacing);\n    border: 1px solid var(--octo-border);\n    border-radius: var(--octo-radius);\n    background: var(--octo-background);\n  }\n  \n  .card img {\n    width: 100%;\n    height: auto;\n    border-radius: var(--octo-radius);\n    margin-bottom: 0.5rem;\n  }\n  \n  .card h3 {\n    margin: 0 0 0.5rem 0;\n    font-size: 1.125rem;\n  }\n  \n  /* Compact render mode */\n  .compact {\n    line-height: 1.5;\n  }\n  \n  /* Common elements */\n  a {\n    color: var(--octo-primary);\n    text-decoration: none;\n  }\n  \n  a:hover {\n    text-decoration: underline;\n  }\n  \n  .description {\n    margin: 0.5rem 0 0 0;\n    color: #666;\n    font-size: 0.875rem;\n    line-height: 1.4;\n  }\n  \n  .date {\n    display: block;\n    margin-top: 0.25rem;\n    font-size: 0.75rem;\n    color: #999;\n  }\n  \n  /* Meta info */\n  .meta {\n    margin-top: var(--octo-spacing);\n    padding-top: var(--octo-spacing);\n    border-top: 1px solid var(--octo-border);\n    text-align: right;\n  }\n  \n  .result-count {\n    font-size: 0.875rem;\n    color: #666;\n  }\n</style>\n"],"names":["ctx"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;EAkEU,IAAM,CAAA,EAAC,QAAQ,UAAM;AAAA,EAAK,IAAM,CAAA,EAAC,WAAO;AAAA,EAAK,IAAM,CAAA,EAAC,SAAK,mBAAA,GAAA;AAM1D,MAAA;AAAA;AAAA,IAAA,OAAO,WAAO,mBAAA;AAAA;AAOd,MAAA;AAAA;AAAA,IAAA,OAAO,SAAK,mBAAA,GAAA;AAAA;;;IAOZ,IAAM,CAAA,EAAC,QAAQ,SAAS,KAAC;AAAA,IAAK,IAAM,CAAA,EAAC,WAAO,kBAAA,GAAA;AAAA;;;;;;;;;;;;;;;;;;AAtBnD,aA+EM,QAAA,KAAA,MAAA;;;;;;;;;;;;;;;MA7EEA,KAAM,CAAA,EAAC,QAAQ,UAAM;AAAA,MAAKA,KAAM,CAAA,EAAC,WAAO;AAAA,MAAKA,KAAM,CAAA,EAAC,OAAK;;;;;;;;;;;;AAM1D;AAAA;AAAA,QAAAA,QAAO;AAAA,QAAO;;;;;;;;;;;;AAOd;AAAA;AAAA,QAAAA,QAAO;AAAA,QAAK;;;;;;;;;;;;;;QAOZA,KAAM,CAAA,EAAC,QAAQ,SAAS,KAAC;AAAA,QAAKA,KAAM,CAAA,EAAC;AAAA,QAAO;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAhC9C;AAAA;AAAA,MAAAA,QAAO;AAAA;AAAO,aAAA;AAET;AAAA;AAAA,MAAAA,QAAO;AAAA;AAAK,aAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAYI,MAAA;AAAA;AAAA,KAAA,UAAK,iBAAa;AAAA;;;;;;;;gBADI,qBACvB;;gBAAoB,GACzC;;;;AAFA,aAES,QAAA,QAAA,MAAA;;;;;;;;;UAFS,IAAI,CAAA;AAAA,QAAA;;;;;AACA,UAAA;AAAA,MAAA,KAAA,cAAA;AAAA,OAAAA,WAAK,iBAAa;AAAA,iBAAA,IAAA,QAAA;AAAA;;;;;;;;;;;;;;;;;;;AAKxC,aAGM,QAAA,MAAA,MAAA;AAAA;;;;;;;;;;;;;AAKwB,MAAA;AAAA;AAAA,IAAA,OAAO,QAAK;AAAA;;;;;;;;;;;;;;;;;;;;;;AAD1C,aAGM,QAAA,KAAA,MAAA;AAFJ,aAA6C,KAAA,CAAA;AAA1C,aAAuB,GAAA,MAAA;;;;AAC1B,aAA2D,KAAA,MAAA;;;;;;UAAzC,IAAI,CAAA;AAAA,QAAA;;;;;AADM,UAAA;AAAA,MAAA,KAAA,cAAA;AAAA,MAAAA,QAAO,QAAK;AAAA,iBAAA,IAAA,QAAA;AAAA;;;;;;;;;;;;;;AAyDZ,MAAA;AAAA;AAAA,IAAA,OAAO,QAAK;AAAA;;;AAAS,MAAA;AAAA;AAAA,IAAA,OAAO,UAAU,IAAI,KAAK;AAAA;;;AAlDxE;AAAA;AAAA,MAAAA,YAAW;AAAA;AAAM,aAAA;AAiBZ;AAAA;AAAA,MAAAA,YAAW;AAAA;AAAO,aAAA;AAsBlB;AAAA;AAAA,MAAAA,YAAW;AAAA;AAAS,aAAA;AAAA;;;;;;;;;;;gBAWa,SAAO;;;;;;;;;AADlD,aAEM,QAAA,KAAA,MAAA;AADJ,aAAsF,KAAA,IAAA;;;;;;;;;;;;;;;;;AAA1D,UAAA;AAAA,MAAA,KAAA,cAAA;AAAA,MAAAA,QAAO,QAAK;AAAA,iBAAA,IAAA,QAAA;AAAS,UAAA;AAAA,MAAA,KAAA,cAAA;AAAA,MAAAA,QAAO,UAAU,IAAI,KAAK;AAAG,iBAAA,IAAA,QAAA;AAAA;;;;;;;;;;;;;;AATrE,MAAA,eAAA;AAAA;AAAA,IAAA,OAAO;AAAA,EAAO;;mCAAnB,QAAI,KAAA,GAAA;;;;;;;;;;;;AADR,aAMM,QAAA,KAAA,MAAA;;;;;;;;;;AALG,uBAAA;AAAA;AAAA,UAAAA,QAAO;AAAA,QAAO;;qCAAnB,QAAI,KAAA,GAAA;;;;;;;;;;;;;0CAAJ;AAAA;;;;;;;;;;;;AAtBK,MAAA,eAAA;AAAA;AAAA,IAAA,OAAO;AAAA,EAAO;;mCAAnB,QAAI,KAAA,GAAA;;;;;;;;;;;;AADR,aAmBM,QAAA,KAAA,MAAA;;;;;;;;;;AAlBG,uBAAA;AAAA;AAAA,UAAAA,QAAO;AAAA,QAAO;;qCAAnB,QAAI,KAAA,GAAA;;;;;;;;;;;;;0CAAJ;AAAA;;;;;;;;;;;;AAjBK,MAAA,aAAA;AAAA;AAAA,IAAA,OAAO;AAAA,EAAO;;iCAAnB,QAAI,KAAA,GAAA;;;;;;;;;;;;AADR,aAcK,QAAA,IAAA,MAAA;;;;;;;;;;AAbI,qBAAA;AAAA;AAAA,UAAAA,QAAO;AAAA,QAAO;;mCAAnB,QAAI,KAAA,GAAA;;;;;;;;;;;;;wCAAJ;AAAA;;;;;;;;;;;;;;eA0CuC,GAAE;AAAA;;;;;;;;;;;;;AADtC,MAAA,WAAA;AAAA;AAAA,IAAS,IAAI,EAAA;AAAA,EAAA,IAAA;;;;;AACP,MAAA;AAAA;AAAA,IAAA;IAAI,IAAM,CAAA,EAAC,QAAQ,SAAS,KAAC,mBAAA;AAAA;;;;;;;;;AAF7B,WAAA,GAAA,QAAA,eAAA;AAAA;AAAA,QAAO,IAAI,EAAA;AAAA,MAAA,CAAA;;;;;;AAApB,aAEI,QAAA,GAAA,MAAA;;;;;;;;AADD,UAAA;AAAA,MAAA,KAAA,cAAA,WAAA;AAAA;AAAA,QAASA,KAAI,EAAA;AAAA,MAAA,IAAA;AAAA,iBAAA,IAAA,QAAA;AADP,UAAA;AAAA,MAAA,KAAA,kBAAA,eAAA;AAAA;AAAA,QAAOA,KAAI,EAAA;AAAA,MAAA,IAAA;;;AAEX;AAAA;AAAA,QAAAA;QAAIA,KAAM,CAAA,EAAC,QAAQ,SAAS;AAAA,QAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAtBxB,UAAA,CAAA,cAAA,IAAA,KAAA;AAAA,MAAA,QAAK,KAAK;AAAA,aAAA,KAAA,OAAA,aAAA;AAAO,WAAA,KAAA,OAAA,gBAAA;AAAA;AAAA,QAAS,IAAI,EAAA;AAAA,MAAA,CAAA;;;;;AAAxC,aAA4D,QAAA,KAAA,MAAA;AAAA;;AAAlD,UAAA;AAAA,MAAA,KAAA,CAAA,cAAA,IAAA,KAAA;AAAA,MAAAA,SAAK,KAAK,GAAA;;;AAAO,UAAA;AAAA,MAAA,KAAA,mBAAA,gBAAA;AAAA;AAAA,QAASA,KAAI,EAAA;AAAA,MAAA,IAAA;;;;;;;;;;;;;AAQhB,MAAA;AAAA;AAAA,IAAA,QAAK,cAAW;AAAA;;;;;;;;;AAAxC,aAA6C,QAAA,GAAA,MAAA;;;;AAArB,UAAA;AAAA,MAAA,KAAA,aAAA;AAAA,MAAAA,SAAK,cAAW;AAAA,iBAAA,GAAA,OAAA;AAAA;;;;;;;;;;gBAGpB;AAAA;AAAA,IAAW,IAAI,EAAA,EAAC;AAAA,EAAI,IAAA;;;;;;;;;AAAxC,aAAiD,QAAA,MAAA,MAAA;;;;;kCAA7B;AAAA;AAAA,QAAWA,KAAI,EAAA,EAAC;AAAA,MAAI,IAAA;AAAA,iBAAA,GAAA,OAAA;AAAA;;;;;;;;;;;;;AAPrC,MAAA,WAAA;AAAA;AAAA,IAAS,IAAI,EAAA;AAAA,EAAA,IAAA;;;;;;AALb,MAAA;AAAA;AAAA,IAAA,QAAK,SAAK,mBAAA,GAAA;AAAA;AAQV,MAAA;AAAA;AAAA,IAAA,QAAK,eAAW,kBAAA,GAAA;AAAA;AAGhB,MAAA;AAAA;AAAA,IAAA,QAAK,QAAI,kBAAA,GAAA;AAAA;;;;;;;;;;;;;;;;;AAPH,WAAA,GAAA,QAAA,eAAA;AAAA;AAAA,QAAO,IAAI,EAAA;AAAA,MAAA,CAAA;;;;;;;;AALxB,aAeU,QAAA,SAAA,MAAA;;;;AAXR,aAIK,SAAA,EAAA;AAHH,aAEI,IAAA,CAAA;;;;;;;;;;;AAND;AAAA;AAAA,QAAAA,SAAK;AAAA,QAAK;;;;;;;;;;;;AAKV,UAAA;AAAA,MAAA,KAAA,cAAA,WAAA;AAAA;AAAA,QAASA,KAAI,EAAA;AAAA,MAAA,IAAA;AAAA,iBAAA,IAAA,QAAA;AADP,UAAA;AAAA,MAAA,KAAA,kBAAA,eAAA;AAAA;AAAA,QAAOA,KAAI,EAAA;AAAA,MAAA,IAAA;;;AAIjB;AAAA;AAAA,QAAAA,SAAK;AAAA,QAAW;;;;;;;;;;;;AAGhB;AAAA;AAAA,QAAAA,SAAK;AAAA,QAAI;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAxBY,MAAA;AAAA;AAAA,IAAA,QAAK,cAAW;AAAA;;;;;;;;;AAAxC,aAA6C,QAAA,GAAA,MAAA;;;;AAArB,UAAA;AAAA,MAAA,KAAA,aAAA;AAAA,MAAAA,SAAK,cAAW;AAAA,iBAAA,GAAA,OAAA;AAAA;;;;;;;;;;gBAGpB;AAAA;AAAA,IAAW,IAAI,EAAA,EAAC;AAAA,EAAI,IAAA;;;;;;;;;AAAxC,aAAiD,QAAA,MAAA,MAAA;;;;;kCAA7B;AAAA;AAAA,QAAWA,KAAI,EAAA,EAAC;AAAA,MAAI,IAAA;AAAA,iBAAA,GAAA,OAAA;AAAA;;;;;;;;;;;AANvC,MAAA,WAAA;AAAA;AAAA,IAAS,IAAI,EAAA;AAAA,EAAA,IAAA;;;;;;AAEX,MAAA;AAAA;AAAA,IAAA,QAAK,eAAW,kBAAA,GAAA;AAAA;AAGhB,MAAA;AAAA;AAAA,IAAA,QAAK,QAAI,kBAAA,GAAA;AAAA;;;;;;;;;;;;;AANL,WAAA,GAAA,QAAA,eAAA;AAAA;AAAA,QAAO,IAAI,EAAA;AAAA,MAAA,CAAA;;;;;;;AADtB,aAUK,QAAA,IAAA,MAAA;AATH,aAEI,IAAA,CAAA;;;;;;;;;;;AADD,UAAA;AAAA,MAAA,KAAA,cAAA,WAAA;AAAA;AAAA,QAASA,KAAI,EAAA;AAAA,MAAA,IAAA;AAAA,iBAAA,IAAA,QAAA;AADP,UAAA;AAAA,MAAA,KAAA,kBAAA,eAAA;AAAA;AAAA,QAAOA,KAAI,EAAA;AAAA,MAAA,IAAA;;;AAGf;AAAA;AAAA,QAAAA,SAAK;AAAA,QAAW;;;;;;;;;;;;AAGhB;AAAA;AAAA,QAAAA,SAAK;AAAA,QAAI;;;;;;;;;;;;;;;;;;;;;;;;;;AAvCH,MAAA;AAAA;AAAA,IAAA,OAAO,QAAK;AAAA;;;;;;;;;AAAjC,aAAyC,QAAA,MAAA,MAAA;;;;AAApB,UAAA;AAAA,MAAA,KAAA,aAAA;AAAA,MAAAA,QAAO,QAAK;AAAA,iBAAA,GAAA,OAAA;AAAA;;;;;;;;;;;;;;;;;AAFjC,aAAkC,QAAA,MAAA,MAAA;AAAA;;;;;;;;;;;;;;;;;;AAFlC,aAAoC,QAAA,MAAA,MAAA;AAAA;;;;;;;;;;;;AAHnC;AAAA;AAAA,MAAAA,YAAW;AAAA;AAAO,aAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA5CV,MAAA,EAAA,SAAS,uBAAsB,IAAA;AAG/B,MAAA,EAAA,IAAI,GAAE,IAAA;AACN,MAAA,EAAA,IAAI,GAAE,IAAA;AACN,MAAA,EAAA,OAAO,GAAE,IAAA;AACT,MAAA,EAAA,OAAO,GAAE,IAAA;AACT,MAAA,EAAA,QAAQ,GAAE,IAAA;AACV,MAAA,EAAA,QAAQ,KAAI,IAAA;AACZ,MAAA,EAAA,SAAS,IAAG,IAAA;AACZ,MAAA,EAAA,OAAO,GAAE,IAAA;AAGT,MAAA,EAAA,WAAW,MAAK,IAAA;AAChB,MAAA,EAAA,SAAS,OAAM,IAAA;AAGpB,QAAA,QAAQ,gBAAgB,SAAS,SAAS;;iBAGjC,OAAI;AACX,UAAA,MAAM,MAAK;AAAA,MACf;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA;;AAKJ,UAAO,MAAA;QACD,YAAY,aAAa,IAAE;AAC7B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}